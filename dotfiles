#! /usr/bin/env bash

FONT_URL=https://github.com/ryanoasis/nerd-fonts/releases/download/v2.2.2/JetBrainsMono.zip
ZSH_PLUGINS_PATH=~/.local/share/zsh-plugins/
oh_my_tmux_path=~/oh-my-tmux

install-configs() {
    echo "Installing configs..."
    stow -vt ~ \
        alacritty \
        bat \
        i3 \
        kitty \
        mpv \
        neofetch \
        nvim \
        qtile \
        ranger \
        rofi \
        starship \
        sxhkd \
        tmux \
        zsh

    echo "Installing mpv shaders..."
    cp -vr _data/shaders ~/.config/mpv/

    echo "Installing Oh-my-tmux plugin..."
    git clone https://github.com/gpakosz/.tmux.git "$oh_my_tmux_path"
    ln -s -f "$oh_my_tmux_path"/.tmux.conf ~/.tmux.conf

    echo "Installing NNN plugins..."
    sh -c "$(curl -Ls https://raw.githubusercontent.com/jarun/nnn/master/plugins/getplugs)"

    echo "Installing Zsh plugins..."
    mkdir -p $ZSH_PLUGINS_PATH
    cd $ZSH_PLUGINS_PATH || return 1
    git clone https://github.com/Aloxaf/fzf-tab
    git clone https://github.com/zsh-users/zsh-autosuggestions
    git clone https://github.com/zsh-users/zsh-completions.git
    # git clone https://github.com/zsh-users/zsh-syntax-highlighting
    git clone https://github.com/zdharma-continuum/fast-syntax-highlighting
    git clone https://github.com/zsh-users/zsh-history-substring-search
    git clone https://github.com/agkozak/zsh-z.git

    echo "Installing fzf..."
    git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
    ~/.fzf/install --no-keybindings --no-completion --no-update-rc
}

install-config() {
    conf=$1
    stow -vt ~ "$conf"
}

install-fonts() {
    echo "Installing fonts..."

    mkdir -p ~/.local/share/fonts
    cd ~/.local/share/fonts/ || exit

    curl -L "$FONT_URL" >JetBrainsMono.zip
    unzip JetBrainsMono.zip -d JetBrainsMono
    fc-cache -f -v
    rm JetBrainsMono.zip
}

adopt-config() {
    program=$1
    echo "Adopting config from [$program]"

    mkdir -p "$program"/.config/"$program"
    stow --adopt --verbose --target ~ "$program"
}

"$@"
